<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Movie Bot | Text To Speech</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Extra styling to match dark theme */
    .tts-section {
      margin-top: 20px;
      padding: 20px;
      background: #1e1e1e;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }
    .tts-section textarea {
      width: 100%;
      min-height: 120px;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #444;
      background: #0f1720;
      color: #f0f0f0;
      resize: none;
      font-size: 15px;
      box-sizing: border-box;
    }
    .tts-section textarea:focus {
      outline: none;
      border-color: #c59d5f;
      box-shadow: 0 0 6px rgba(197,157,95,0.6);
    }
    .tts-buttons {
      margin-top: 15px;
    }
    .tts-buttons button {
      background: #c59d5f;
      border: none;
      padding: 10px 16px;
      margin-right: 10px;
      border-radius: 6px;
      color: #fff;
      font-size: 15px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .tts-buttons button:hover {
      transform: translateY(-2px);
      background: #e0b97d;
    }
    #ttsStatus {
      margin-top: 12px;
      font-weight: bold;
      color: #9aa7bb;
    }
    #ttsIndicator {
      margin-top: 6px;
      font-weight: bold;
      color: #ffae42;
      display: none;
      animation: pulse 1s infinite;
    }
    @keyframes pulse {
      0% { opacity: 0.3; }
      50% { opacity: 1; }
      100% { opacity: 0.3; }
    }
  </style>
</head>
<body>
  <!-- Same header/nav as other pages -->
  <header>
  <h1>üé¨ Movie Recommendation Bot</h1>
  <button class="menu-toggle" onclick="toggleMenu()">‚ò∞</button>
  <nav id="navbar">
    <a href="home.html">Home</a>
    <a href="about.html">About</a>
    <a href="textToSpeach.html">Text To Speach</a>
    <a href="sentimentEnalysis.html">Sentiment Analysis</a>
    <a href="index.html">Logout</a>
  </nav>
</header>

  <div class="container">
    <h2>Text to Speech üîä</h2>
    <p>
      Type something below and let our bot convert it into natural speech.
    </p>

    <section class="tts-section">
      <textarea id="ttsInput" placeholder="Type something to hear..."></textarea>
      <div class="tts-buttons">
        <button onclick="speakText()">Speak</button>
      </div>
      <div id="ttsStatus"></div>
      <div id="ttsIndicator">üîà Speaking...</div>
    </section>
  </div>

  <!-- IBM Watson Chatbot (same across all pages) -->
  <script>
  window.watsonAssistantChatOptions = {
    integrationID: "154f1ff2-1959-4e24-a82b-19c27cd89640",
    region: "au-syd",
    serviceInstanceID: "efbaef90-38d4-4001-bb7f-f9620d4aa8cc",
    onLoad: async (instance) => { await instance.render(); }
  };
  setTimeout(function(){
    const t=document.createElement('script');
    t.src="https://web-chat.global.assistant.watson.appdomain.cloud/versions/" +
      (window.watsonAssistantChatOptions.clientVersion || 'latest') +
      "/WatsonAssistantChatEntry.js";
    document.head.appendChild(t);
  }, 500);
  </script>

  <!-- Inline JS for Text to Speech -->
  <script>
    const TTS_API_KEY = "FQbKkjo43y74cnbzgdvotaEv3z1IYMxjakqqGy4a6L6p";
    const TTS_URL = "https://api.au-syd.text-to-speech.watson.cloud.ibm.com/instances/67403f15-8dd1-4b81-9a6b-9a75e960d099";

    async function speakText() {
      const text = document.getElementById("ttsInput").value.trim();
      const status = document.getElementById("ttsStatus");
      const indicator = document.getElementById("ttsIndicator");
      status.textContent = "";
      indicator.style.display = "none";

      if (!text) {
        status.style.color = "red";
        status.textContent = "‚ö†Ô∏è Please enter some text!";
        return;
      }

      indicator.style.display = "block";

      try {
        const resp = await fetch(`${TTS_URL}/v1/synthesize?voice=en-US_AllisonV3Voice`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Accept": "audio/mp3",
            "Authorization": "Basic " + btoa("apikey:" + TTS_API_KEY)
          },
          body: JSON.stringify({ text })
        });

        if (!resp.ok) throw new Error(await resp.text());

        const blob = await resp.blob();
        const audioUrl = URL.createObjectURL(blob);
        const audio = new Audio(audioUrl);
        audio.play();
        audio.onended = () => {
          indicator.style.display = "none";
          status.style.color = "#27ae60";
          status.textContent = "‚úÖ Speech complete!";
        };
      } catch (err) {
        console.error("TTS error:", err);
        indicator.style.display = "none";
        status.style.color = "red";
        status.textContent = "‚ùå Error generating speech!";
      }
    }
  </script>
</body>
<script>
  function toggleMenu() {
    document.getElementById("navbar").classList.toggle("active");
  }
</script>
</html>
